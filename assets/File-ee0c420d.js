import{f as K,g as u,h as Q,i as W,j as T,r as p,o as i,c as r,a as _,e as t,w as o,b as D,u as c,v as $,z as X,k as Z,l as ee,p as te,t as le,F as E,m as ae,n as ne,E as oe,_ as se}from"./app-66188d86.js";const ie={style:{display:"flex",margin:"10px 0"}},re={key:0,style:{width:"100%",height:"100%"}},de=["src"],ue=["src"],ce={class:"el-upload-list__item-actions"},pe=["onClick"],_e=["onClick"],ge=["src"],fe=["src"],he={class:"box"},ve={key:0,class:"video"},me=["onClick","src"],ye={class:"icon"},we={key:1},xe={style:{display:"flex","justify-content":"center"}},be={key:0,style:{display:"flex","justify-content":"center"}},Ce=["src"],ke={key:1,style:{display:"flex","justify-content":"center"}},Ve=K({__name:"File",setup(ze){const m=u(""),b=u(!1),P=u(!1),U=u(1),L=u(10);let F=u(0);const f=u([]);let S=u([]),C=Q({page:1,pageSize:10});const y=u(""),k=u(!1);let v=u(null);const j=e=>{let l=f.value.findIndex(d=>d.name===e.name);f.value.splice(l,1)},M=e=>{y.value=e,k.value=!0},H=async(e,l)=>{f.value.push(e)},O=async()=>{if(!f.value.length)return oe.error("请先添加文件");let e=new FormData;e.append("time",new Date().getTime()),e.append("content",m.value),f.value.forEach(l=>{e.append("test",l.raw)}),await T({method:"post",url:"http://47.100.33.103:3001/file/uploadFile",data:e,headers:{"Content-Type":"multipart/form-data"}}),f.value=[],m.value="",w()};W(()=>{w()});const w=async()=>{const{data:e}=await T({method:"post",url:"http://47.100.33.103:3001/file/getBlog",data:C});S.value=e.data.results,F.value=e.data.total},R=e=>{C.pageSize=e,w()},q=e=>{C.page=e,w()},V=e=>{b.value=!0,v.value=e},J=(e,l)=>{(""+e).length===10?e=parseInt(e)*1e3:e=+e;const d=new Date(e),n=(Date.now()-d)/1e3;return n<30?"刚刚":n<3600?Math.ceil(n/60)+"分钟前":n<3600*24?Math.ceil(n/3600)+"小时前":n<3600*24*2?"1天前":l?Y(e,l):d.getMonth()+1+"月"+d.getDate()+"日"+d.getHours()+"时"+d.getMinutes()+"分"},Y=(e,l)=>{if(arguments.length===0||!e)return null;const d=l||"{y}-{m}-{d} {h}:{i}:{s}";let s;typeof e=="object"?s=e:(typeof e=="string"&&(/^[0-9]+$/.test(e)?e=parseInt(e):e=e.replace(new RegExp(/-/gm),"/")),typeof e=="number"&&e.toString().length===10&&(e=e*1e3),s=new Date(e));const n={y:s.getFullYear(),m:s.getMonth()+1,d:s.getDate(),h:s.getHours(),i:s.getMinutes(),s:s.getSeconds(),a:s.getDay()};return d.replace(/{([ymdhisa])+}/g,(z,x)=>{const h=n[x];return x==="a"?["日","一","二","三","四","五","六"][h]:h.toString().padStart(2,"0")})};return(e,l)=>{const d=p("el-input"),s=p("el-button"),n=p("el-icon"),B=p("el-upload"),z=p("el-dialog"),x=p("el-divider"),h=p("el-table-column"),I=p("el-image"),A=p("el-table"),G=p("el-pagination");return i(),r(E,null,[_("div",ie,[t(d,{modelValue:m.value,"onUpdate:modelValue":l[0]||(l[0]=a=>m.value=a),placeholder:"请输入描述",maxlength:"5"},null,8,["modelValue"]),t(s,{onClick:O},{default:o(()=>[D("上传")]),_:1})]),t(B,{"file-list":f.value,"onUpdate:fileList":l[1]||(l[1]=a=>f.value=a),action:"#",drag:"","auto-upload":!1,"list-type":"picture-card","on-preview":M,"on-remove":j,multiple:"",limit:9,accept:".png,.jpg,.jpeg,.mp4","on-change":H},{file:o(({file:a})=>[_("div",null,[a.name.split(".")[1]==="mp4"?(i(),r("div",re,[_("video",{style:{width:"100%",height:"100%"},src:a.url},null,8,de),t(n,{size:30,style:{color:"red",position:"absolute",left:"50%",top:"50%",transform:"translate(-50%,-50%)"}},{default:o(()=>[t(c($))]),_:1})])):(i(),r("img",{key:1,class:"el-upload-list__item-thumbnail",src:a.url,alt:""},null,8,ue)),_("span",ce,[_("span",{class:"el-upload-list__item-preview",onClick:g=>M(a)},[t(n,null,{default:o(()=>[t(c(X))]),_:1})],8,pe),P.value?ee("v-if",!0):(i(),r("span",{key:0,class:"el-upload-list__item-delete",onClick:g=>j(a)},[t(n,null,{default:o(()=>[t(c(Z))]),_:1})],8,_e))])])]),default:o(()=>[t(n,null,{default:o(()=>[t(c(te))]),_:1})]),_:1},8,["file-list"]),t(z,{modelValue:k.value,"onUpdate:modelValue":l[2]||(l[2]=a=>k.value=a)},{default:o(()=>[y.value.name.split(".")[1]==="mp4"?(i(),r("video",{key:0,src:y.value.url,style:{width:"100%",height:"100%"},controls:"",autoplay:""},null,8,ge)):(i(),r("img",{key:1,"w-full":"",src:y.value.url,alt:"Preview Image"},null,8,fe))]),_:1},8,["modelValue"]),t(x,{"content-position":"right"},{default:o(()=>[D("预览")]),_:1}),t(A,{data:c(S),style:{width:"100%"},border:""},{default:o(()=>[t(h,{type:"index",align:"center",label:"序号",width:"60"}),t(h,{label:"Name",align:"center",width:"100"},{default:o(({row:a})=>[D(le(J(a.time,0)),1)]),_:1}),t(h,{prop:"content",align:"center",label:"描述",width:"100"}),t(h,{prop:"url",label:"url",align:"center"},{default:o(({row:a})=>[_("div",he,[(i(!0),r(E,null,ae(JSON.parse(a.url),(g,De)=>(i(),r("div",null,[g.split(".")[g.split(".").length-1]==="mp4"?(i(),r("div",ve,[_("video",{class:"widthBox",onClick:N=>V(g),src:g},null,8,me),_("div",ye,[t(n,{size:30,style:{color:"red"},onClick:N=>V(g)},{default:o(()=>[t(c($))]),_:2},1032,["onClick"])])])):(i(),r("div",we,[t(I,{onClick:ne(N=>V(g),["stop"]),lazy:"",style:{width:"100px",height:"100px",margin:"5px"},src:g,fit:"scale-down"},null,8,["onClick","src"])]))]))),256))])]),_:1})]),_:1},8,["data"]),t(G,{style:{margin:"20px 0"},"current-page":U.value,"page-size":L.value,"page-sizes":[5,10,20,30],small:!0,background:!0,layout:"->,total, sizes, prev, pager, next, jumper",total:c(F),onSizeChange:R,onCurrentChange:q},null,8,["current-page","page-size","total"]),t(z,{modelValue:b.value,"onUpdate:modelValue":l[3]||(l[3]=a=>b.value=a),title:"Tips",width:"50%",draggable:""},{default:o(()=>[_("div",xe,[c(v).split(".")[c(v).split(".").length-1]==="mp4"?(i(),r("div",be,[_("video",{style:{width:"80%",margin:"5px"},controls:"",src:c(v)},null,8,Ce)])):(i(),r("div",ke,[t(I,{style:{width:"80%",margin:"5px"},src:c(v),fit:"scale-down"},null,8,["src"])]))])]),_:1},8,["modelValue"])],64)}}});const Se=se(Ve,[["__scopeId","data-v-d59fe1a8"],["__file","File.vue"]]);export{Se as default};
