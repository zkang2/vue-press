import{_ as T,g as w,h as N,r as _,o as B,A as F,w as m,e as r,b as f,u as d,k as M,E as y}from"./app-2a2d66f9.js";const U={__name:"Table",setup(E){const b=w();let a=N({tableData:[{name:"Tom",money:""}]});const i=(e,l,o)=>{a.tableData.filter(t=>t.name===l).length>1?(y({message:"姓名重复",type:"warning"}),o(new Error("姓名重复"))):o()},g=()=>{a.tableData.push({})},D=e=>{a.tableData.splice(e,1)},$=async e=>{e&&await e.validate((l,o)=>{if(l)console.log("submit!");else{let n=[];console.log("error submit!",o),Object.keys(o).forEach(t=>{o[t].map(s=>{n.push(s.message)})}),n=n.join(","),y({message:n,type:"warning"})}})},v=e=>{a.tableData[e].money=a.tableData[e].money.replace(/^\D*(\d{0,8}(?:\.\d{0,2})?).*$/g,"$1"),a.tableData[e].money=a.tableData[e].money.replace(/[^\d\.]/g,""),a.tableData[e].money=a.tableData[e].money.replace(/^\./g,""),a.tableData[e].money=a.tableData[e].money.replace(/\.{2,}/g,"."),a.tableData[e].money=a.tableData[e].money.replace(/^0\d[0-9]*/g,""),a.tableData[e].money=a.tableData[e].money.replace(".","$#$").replace(/\./g,"").replace("$#$","."),a.tableData[e].money=a.tableData[e].money.replace(/^(\-)*(\d+)\.(\d\d).*$/,"$1$2.$3")},V=e=>{a.tableData[e].money=h(a.tableData[e].money)},h=(e,l=2,o=!0)=>{if(!e||isNaN(parseFloat(e)))return e;const n=Math.pow(10,l);o&&(e=Math.round(e*n)/n);let t=e.toString(),s=0;return t.indexOf(".")==-1?(s=l,t+="."):s=l-(t.length-1-t.indexOf(".")),t+="0".repeat(s>0?s:0),t};return(e,l)=>{const o=_("el-button"),n=_("el-form-item"),t=_("el-input"),s=_("el-table-column"),k=_("el-table"),C=_("el-form");return B(),F(C,{model:d(a),ref_key:"ruleFormRef",ref:b},{default:m(()=>[r(n,{style:{margin:"10px 0"}},{default:m(()=>[r(o,{type:"primary",onClick:g},{default:m(()=>[f("加一行")]),_:1}),r(o,{type:"primary",onClick:l[0]||(l[0]=p=>$(b.value))},{default:m(()=>[f("提交")]),_:1})]),_:1}),r(k,{data:d(a).tableData,border:""},{default:m(()=>[r(s,{prop:"name",label:"姓名"},{default:m(({row:p,$index:u})=>[r(n,{prop:`tableData.${u}.name`,rules:[{required:!0,message:"请输入姓名"},{validator:i,name:p.name}]},{default:m(()=>[r(t,{modelValue:p.name,"onUpdate:modelValue":c=>p.name=c},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1032,["prop","rules"])]),_:1}),r(s,{prop:"money",label:"money"},{default:m(({row:p,$index:u})=>[r(n,{prop:`tableData.${u}.money`,rules:[{required:!0,message:"请输入money"}]},{default:m(()=>[r(t,{modelValue:p.money,"onUpdate:modelValue":c=>p.money=c,onInput:c=>v(u),onBlur:c=>V(u)},null,8,["modelValue","onUpdate:modelValue","onInput","onBlur"])]),_:2},1032,["prop"])]),_:1}),r(s,{label:"操作"},{default:m(({row:p,$index:u})=>[r(o,{type:"danger",icon:d(M),onClick:l[1]||(l[1]=c=>D(e.index)),circle:""},null,8,["icon"])]),_:1})]),_:1},8,["data"])]),_:1},8,["model"])}}},O=T(U,[["__scopeId","data-v-c84519fa"],["__file","Table.vue"]]);export{O as default};
